◎ WSO2 Hue web UI SSO 구축하기
    - 지난주 진행상황

        지난주에는 hue metadata를 받는데 계속 실패를 하다가 마지막에 성공을 하고는 sso 로그인 페이지까지 띄우는데 성공을 하였고 로그인까지 성공하였다.


◎ WSO2 Cloudera Manager SSO 구축하기
    이번주 부터는 ADFS의 구성으로 넘어갔다. 기존에 하던 WSO2를 이용해 SSO를 구축하는 것보다 사안이 더 중요하기 때문이다. 

◎ ADFS HUE SSO 구축하기

    - 해결해야 될 문제
        
        WSO2에서 성공시킨 SSO구축을 ADFS에서 성공시키고 USER와 GROUP, ROLE이 적용이 되게 해야한다.

    - 해결 시도

        우선 앞서 구성하였던 CM SSO를 참고하여서 ADFS를 이용하여 SSO구축을 시도하였다.
        전체적인 틀은 WSO2와 크게 다르지 않았다. 우선 HUE SERVER가 올려진 노드에서 키와 인증서를 만든다. 만들어진 인증서를 AD에도 저장을 시킨다. 해당 인증서와 키를 hue에 적용을 시킨다. 인증서와 키를 적용시키는 것은 
◎ ADFS Hue web UI SSO 구축하기
    
◎ 리눅스 네트워크 물리적인 포트(이더넷)을 주는 방법
    - 해결해야 될 문제
        리눅스 계열의 OS를 기반으로 클러스트를 구축할때 현재는 호스트 전용 네트워크로 구성하거나 NAT방식을 이용하여 로컬 컴퓨터의 vitualbox나 vmware 전용의 연결 포트를 이용하여 연결을 해 주었었다. 이러한 방식은 직접 연결이 아니라 vm의 연결포트가 로컬의 연결 포트를 거쳐서 가는 방식이라 이를 물리적인 직접연결처럼 구성을 할 수 없는지에 대한 방법을 알아내는게 이번 목표이다.

    - 해결 시도

        우선 가상머신의 네트워크 구성 방법은 다음과 같다.
![image](https://user-images.githubusercontent.com/37497189/58400693-cfb97b80-8096-11e9-892b-c67b25f27e2c.png)
        위의 그림과 같이 네트워크를 구성하는데 자주 쓰이는 방식은 현재 호스트 전용 어댑터와  NAT 네트워크 방식이다. 호스트 전용 어댑터의 경우 호트스 머신들 간의 통신은 되지만 외부에서 접속하려고 하면 접속이 되질 않은다.
        NAT 네트워크 방식은 게스트 OS 내부에서 인터넷을 사용할 수 있는 내부망 모드인데 공유기의 기능과 동일하다고 보면된다. 가상 머신환경들간은 내부로 묶이게 되면 외부에서는 접근을 할 수 없다. 반면 NAT방식은 NAT 환경에서 가상머신을 구동하면 실제 컴퓨팅 환경과 동일한 방법으로 라우터에 연결되게 된다. 단, 이때 라우터는 VirtualBox 네트워킹 엔진의 일부로써, '각각의' 가상 머신과 호스트 사이에 위치하며 이로써 가상 머신간의 통신은 지원하지 않는다. (가상머신마다 독립적인 NAT 라우터와 1:1로 연결되어 있다고 생각할 수 있다.)가상 머신에서 발송된 패킷은 네트워킹 엔진에 의해 처리되는데, 이 과정에서 마치 네트워킹 엔진(호스트IP:네트워킹엔진Port)과 서버간의 통신이 이루어지는것으로 보이게 된다. 외부에서 NAT방식의 가상머신에 telnet이나 ssh로 연결을 할려면 포트포워딩을 통해 해주면 된다.
        Bridge 연결은 게스트 OS와 호스트 OS가 같은 레벨의 네트워크에 있다고 보면 된다. 쉽게 설명하면 게스트 OS에 고정 IP를 할당해서 사용한다고 보면 된다. 이렇게 설정할 경우 외부에서 접속하는 것도 따로 설정할 필요가 없게되고 호스트-게스트 OS간 접속도 원할하게 된다. 위의 연결 방식 모두 물리적인 네트워크 연결이 아닌 가상머신에서 제공하는 연결방식을 지원받아 연결하는 것이라 해결해야하는 문제랑 거리가 있다는 것을 알 수 있었다.
        따라서 다른 방법을 찾아 보았는데 해당 방법은 다음 url을 참고하였다.
        참고 : http://blog.naver.com/PostView.nhn?blogId=skauter&logNo=10165729297
        내용에 따르면 이더넷과 virtualbox의 호스트 전용 어댑터를 bridge로 연결하여 사용하여서 마치 이더넷에 직접 연결한 것처럼 연결을 하는 방식이다.
        1. 먼저 설치된 virtual box의 centOS 리눅스의 설정에서 호스트 전용어댑터를 적용시킨다.

        2. 윈도우 바탕화면에서 내 네트워크 환경 아이콘을 마우스 오른쪽 클릭하여 속성창을 연다. 네트워크 연결에서 보이는 이더넷과 virtualbox 호스트 어댑터를 두개 마우스 드래그나 ctrl을 누른 상태에서 두개를 선택후 마우스 오른쪽올 클릭해서 나타나는 메뉴 중 연결 브리지를 선택한다. 그러면 자동으로 이더넷과 호스트 어댑터를 브릿지 연결을 잡아주게되는데 설정후 이를 사용할 수 있게 된다.
![image](https://user-images.githubusercontent.com/37497189/58403915-d4822d80-809e-11e9-8733-0d6642aaf8d4.png)      

![image](https://user-images.githubusercontent.com/37497189/58404372-f03a0380-809f-11e9-9bc5-b8d78b946060.png)

    위의 사진과 같이 브릿지 연결이 된 어댑터가 준비가 되면 오른쪽 클릭후에 설정 페이지에서 ipv4설정을 해주면 된다. 이렇게 되면 이 어댑터를 virtualbox가 직접 사용하게 되어서 이더넷에 직접 연결하는 효과를 낼 수 있다. 이게 완벽한 해결법인지 확실치 않지만 해당 문제는 여기까지 조사하기로 하였다. 

◎ 외장하드에서 데이터 빼내기
    - 해결해야 될 문제
        1. 다른 회사에서 받아온 외장하드에서 데이터를 빼내서 우리 컴퓨터의 외장하드에 넣는게 이슈이다.
        
        2. 외장하드가 리눅스 계열의 OS에서 사용되던 것이라 윈도우 OS인 우리 컴퓨터에서 인식 시키려고 하면 파일 시스템에서는 보이지 않는 현상이 나타났다.

    - 해결 시도
        1. 시작 메뉴에서 컴퓨터 관리를 검색해서 들어가면 왼쪽 카테고리 중에 저장소 목록이 있는데 하위 메뉴인 디스크 관리를 열어보면 현재 컴퓨터에서 관리되는 디스크들의 목록과 상태를 확인 할 수 있다.
![image](https://user-images.githubusercontent.com/37497189/58399197-5750bb80-8092-11e9-8e0d-cacf8a5462cc.png)

        2. 새로 인식시킨 외장하드는 GPT보호 파티션으로 보호되는 파티션이라고 나와있다.

        3. GPT 보호 파티션은 32비트 컴퓨터에 외장하드를 연결할때 GPT 보호 파티션으로 인식하게 된다. Macintosh 전용 파일시스템을 윈도우 시스템에 연결하거나 그 반대의 경우에도 GPT 보호 파티션으로 인식되기도 한다. GPT 보호 파티션이 표시되면 사용자는 디스크 관리를 통해 디스크의 파티션을 열거나 다른 작업을 할 수 없게 된다.(파티션 분할, 현식, 포맷, 액세스) 그러므로 GPT 보호 파티션을 제거하려면 명령 프롬프트에서 DISK CLEAN 명령어를 실행하거나 무손실로 데이터를 보존하려면 특정 프로그램을 통해 GPT를 MBR로 수정해야 된다.

        4. GPT보호 파티션을 푸는 방법에 대해 찾아보니 세가지의 방법이 나왔다.

    - 해결 방법

        정확히 해결 방법을 통해서 해결을 한 문제가 아니라 방법론에 대해 얘기를 해보자면

        1. 명령 프롬프트에서 DISKPART 명령어 실행
        해당 방법은 디스크의 내용을 포맷시키는 방법이다. 디스크 안의 내용이 다 지워지는 손실 복구이기 때문에 이 방법은 사용하지 않는다. 이 방법은 DISKPART 명령어로 GTP 보호 파티션을 포맷시키고 할당되지 않은 공간에 새로운 MBR파티션을 만드는 방법이다.

        2. 다음 방법은 데이터를 무손실로 복구를 하는 방법인데 이것은 툴을 이용하는 방법이다. 윈도우 10,8,7에서 GTP 보호 파티션을 해제할 수 있고 32비트 운영체제까지 지원이 된다고 설명되어있다. 툴을 까는 url은 아래의 url로 들어가면 된다.
        https://www.easeus.com/partition-master/access-gpt-protective-partition-without-losing-data.html

        이 툴은 무료버전과 유료버전이 있는데 위의 버전은 유료버전이고 아래의 url은 무료 버전이다.
        http://www.disk-partition.com/download.html
        두 툴의 차이는 지원되는 범위의 차이이다. 설명 상으로는 무료 버전도 GPT 방식의 데이터 외장하드의 방식을 MBR로 바꾼는 것을 지원한다고 나와 있는데 확실히 데이터의 손실 없이 바꿔지는지는 확인할 필요가 있기 때문에 적용은 하지 않았다.

        3.마지막 세번째 방식은 업체에 맡기는 것이다. 데이터 복구업체쪽으로 가면 디스크를 손실없이 바꿔 줄 것인데 비용의 문제가 있긴 하다.

    따라서 해당 문제는 사안을 조금 더 두고보고 결정을 하기로 하였다.
    관련 링크 : https://m.blog.naver.com/cbllab/221223836303


◎ 다음주 해결해야 될 문제

    1. ADFS에서 사용자 GROUP 정보와 해당 role들의 정보를 받아와서 적용을 시켜 줘야 된다.

    2. Hue 로그인 시 ADFS에서 제공되는 로그인 페이지로 바로 안가지고 새로고침이 계속 일어나는 상황을 고쳐야 된다.

    3. claim을 지금은 하나밖에 적용을 못하는데 여러개의 클레임을 적용시키는 방법을 찾아야 한다.